# Export Report - 리포트 내보내기

teacher_report.html 파일을 읽어 CSV 또는 PDF 형식으로 내보냅니다.

## 입력 파라미터

- **출력 형식**: $1 (첫 번째 인자)
- **출력 경로**: $2 (선택, 기본값: ./exports/)
- 입력 형식: `$ARGUMENTS` = "형식 [경로]"

## 사용 가능한 형식

| 형식 | 설명 | 확장자 |
|-----|------|-------|
| `csv` | 데이터 테이블 형식 | .csv |
| `pdf` | 인쇄용 문서 형식 | .pdf |
| `both` | CSV와 PDF 모두 생성 | .csv, .pdf |

## 수행 작업

### 1단계: 소스 파일 읽기
```
[Step 1] teacher_report.html 읽기
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
소스: teacher_report.html
상태: ✅ 파일 발견
크기: N KB
최종 수정: 2024-01-31 14:30:00
```

### 2단계: 데이터 파싱
```
[Step 2] HTML 데이터 파싱
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
추출된 테이블: N개
추출된 학생 수: N명
추출된 필드:
  - 학생ID
  - 이름
  - 반
  - 평균점수
  - 순위
  - 등급
  - 카테고리별 점수
```

### 3단계: 형식 변환 및 저장

#### CSV 출력
```
[Step 3] CSV 변환
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
출력 파일: exports/teacher_report_20240131_143000.csv

CSV 구조:
학생ID,이름,반,평균점수,순위,등급,일반상식,과학,역사,지리
STU001,홍길동,1반,820,8,A,850,780,820,830
STU002,김철수,2반,920,1,A,900,950,910,920
...

✅ CSV 저장 완료 (N KB)
```

#### PDF 출력
```
[Step 3] PDF 변환
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
출력 파일: exports/teacher_report_20240131_143000.pdf

PDF 구성:
  - 1페이지: 요약 대시보드
  - 2페이지: 전체 순위표
  - 3페이지~: 반별 성적표

✅ PDF 저장 완료 (N KB)
```

## 출력 형식

### CSV 파일 구조
```csv
학생ID,이름,반,평균점수,순위,상위비율,등급,일반상식,과학,역사,지리,응시횟수,최근응시일
STU001,홍길동,1반,820,8,16%,A,850,780,820,830,15,2024-01-30
STU002,김철수,2반,920,1,2%,A,900,950,910,920,12,2024-01-31
STU003,이영희,1반,780,15,30%,B,800,750,790,780,10,2024-01-29
```

### PDF 파일 구조
```
┌────────────────────────────────────────────────────┐
│                 성적 리포트                         │
│              2024년 1월 31일 발급                   │
├────────────────────────────────────────────────────┤
│                                                    │
│  [요약]                                            │
│  총 학생: 50명 | 평균: 756점 | 응시: 432회         │
│                                                    │
│  [등급 분포]                                       │
│  A(상위20%): 10명 | B(상위40%): 10명               │
│  C(상위70%): 15명 | D(하위30%): 15명               │
│                                                    │
│  [전체 순위표]                                     │
│  ┌──────┬────────┬──────┬───────┬────────┐        │
│  │ 순위 │ 이름   │ 반   │ 평균  │ 등급   │        │
│  ├──────┼────────┼──────┼───────┼────────┤        │
│  │  1   │ 김철수 │ 2반  │ 920   │ A      │        │
│  │  2   │ 이영희 │ 2반  │ 905   │ A      │        │
│  │ ...  │ ...    │ ...  │ ...   │ ...    │        │
│  └──────┴────────┴──────┴───────┴────────┘        │
│                                                    │
└────────────────────────────────────────────────────┘
```

## 완료 보고

```
╔══════════════════════════════════════════════════════════════╗
║                   📤 Export 완료                             ║
╠══════════════════════════════════════════════════════════════╣
║                                                              ║
║  소스 파일: teacher_report.html                              ║
║  처리 시간: 2024-01-31 14:30:00                              ║
║                                                              ║
║  생성된 파일:                                                 ║
║  ┌─────────────────────────────────────────────────────┐     ║
║  │ 📄 exports/teacher_report_20240131_143000.csv       │     ║
║  │    크기: 12 KB | 행: 51 (헤더 포함)                 │     ║
║  ├─────────────────────────────────────────────────────┤     ║
║  │ 📕 exports/teacher_report_20240131_143000.pdf       │     ║
║  │    크기: 156 KB | 페이지: 5                         │     ║
║  └─────────────────────────────────────────────────────┘     ║
║                                                              ║
║  ✅ 내보내기 성공                                             ║
║                                                              ║
╚══════════════════════════════════════════════════════════════╝
```

## 사용 예시

```
/project:export-report csv               # CSV로 내보내기
/project:export-report pdf               # PDF로 내보내기
/project:export-report both              # CSV와 PDF 모두
/project:export-report csv ./reports/    # 지정 경로에 CSV 저장
/project:export-report pdf ~/Downloads/  # 다운로드 폴더에 PDF 저장
```

## 오류 처리

| 오류 | 원인 | 해결 방법 |
|-----|------|----------|
| 소스 파일 없음 | teacher_report.html 미존재 | 먼저 리포트 생성 필요 |
| 파싱 실패 | HTML 구조 불일치 | HTML 형식 확인 |
| 저장 실패 | 경로 권한 없음 | 출력 경로 권한 확인 |
| PDF 변환 실패 | 변환 도구 미설치 | wkhtmltopdf 등 설치 |

## 주의사항

- teacher_report.html 파일이 먼저 존재해야 함
- PDF 변환 시 한글 폰트 설정 확인 필요
- 대용량 데이터 시 처리 시간 증가
- 기존 파일과 이름 충돌 시 타임스탬프로 구분
